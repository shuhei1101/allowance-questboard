# 家族作成画面実装
- 名前: FamilyRegisterPage

## 概要
- 新規家族と親情報を登録する画面
- 家族情報と親情報の両方のフォームを管理
- 親情報編集画面への遷移機能付き
- authRouter.registerFamilyでの登録処理

## props
- 確定ボタンハンドル
  - 引数: 親id?

## 状態
### 家族form
- 家族情報のform
#### 項目
- 家族### フロントエンド (モデル)
- [x] familyRegisterForm
  - ファイルパス: `@frontend/src/features/fami### フロントエンド (Components - 入力)
- 各コンポーネント作成後、デモ画面のコンポーネント一覧にも配置すること
- 
- [x] FamilyNameInput
  - ファイルパス: `@frontend/src/features/family/family-register-page/components/FamilyNameInput.tsx`
  - 概要:
    - 家族名入力コンポーネント
    - 後ろに"家"の固定文字付きy-register-page/models/familyRegisterForm.ts`
  - 概要:
    - 家族登録フォームデータモデル
    - 家族情報と親情報を含む
    - BaseFormを継承イン家族名
- 家族id
### 親form
- 親情報のform
- 親情報編集画面から戻ってきたときに更新する
#### 項目
- 名前
- アイコン
- 誕生日

## 画面項目

### 戻るボタン
- expo標準

### タイトル
- 値: 新規家族作成

### 確定ボタン
- shared/ComfirmButton.tsx
#### 押下時
- authRouter.registerFamilyにデータを渡して実行
  - 先に家族を登録し、その後、生成された家族idで親情報を登録する
  - 戻り値として、親idと家族idを返却する
- 正常に作成できたら、確定ボタンハンドル(家族id, 親id)を実行する。

### 家族名入力
- EntryLayout使用
- タイトル: 家族名
- アイコン: home-outline
- 入力ボックス
  - 表示: [     ]家
  - プレースホルダ: 例: 田中

### オンライン家族名
- EntryLayout使用
- タイトル: オンライン家族名
- アイコン: globe-outline
- helpText: "この家族名はオンライン上で使用されます。"（インフォメーションボタンで表示）
- 入力ボックス
  - 表示: [     ]家
  - プレースホルダ: 例: 田中

### ID入力
- EntryLayout使用
- タイトル: 家族ID
- アイコン: at-outline
- 補足: 入力ボックスの手前に`@`を表示

### 家紋選択
- EntryLayout使用
- タイトル: 家紋
- アイコン: diamond-outline
- 選択ボタン
  - 左側: 選択された家紋アイコンを表示（デフォルト: diamond）
  - 右側: 右矢印（>）
  - 全体がタップ可能

### 親情報
- EntryLayout使用
- タイトル: 親情報
- アイコン: person-outline
- 表示内容: "(親ユーザ名)" または "(未設定)"
- 右端に`>`アイコンを表示
- 上記レイアウトは基底コンポーネントとして定義する。
  - 右端に`>`アイコンを表示
  - 引数で受け取ったコンポーネントを`>`アイコンの左に表示する
  - 幅いっぱいに広がる
  - EntryLayoutの子要素に入れる前提のコンポーネント
#### 押下時
- 親編集画面へ遷移（ParentEditPage）
  - shouldUpdate: -（更新せずに戻るだけ）
  - parentId: 状態.親.id
  - handleParentForm: 自身の状態.set親(form)とする

## 画面レイアウト

```plaintext
|-------------------------------|
| ←        新規家族作成      ✓  |
|-------------------------------|
| ◇ 家族名                     |
| [田中        ]家              |
|                              |
| ◇ オンライン家族名 ⓘ         |
| [田中        ]家              |
|                              |
| ◇ 家族ID                     |
| @[tanaka_family]             |
|                              |
| ◇ 家紋                       |
|                   選択なし >  |
|                              |
| ◇ 親情報                     |
|               (親ユーザ名) >  |
|                              |
|-------------------------------|
```

## 実装計画

### バックエンド (値オブジェクト)
- [x] FamilyId
  - ファイルパス: `@backend/src/features/family/value-object/familyId.ts`
  - 概要: 家族IDを表す値オブジェクト

- [x] FamilyName
  - ファイルパス: `@backend/src/features/family/value-object/familyName.ts`
  - 概要: 家族名を表す値オブジェクト

- [x] FamilyOnlineName
  - ファイルパス: `@backend/src/features/family/value-object/familyOnlineName.ts`
  - 概要: オンライン家族名を表す値オブジェクト

- [x] FamilyDisplayId
  - ファイルパス: `@backend/src/features/family/value-object/familyDisplayId.ts`
  - 概要: 家族表示IDを表す値オブジェクト

- [x] FamilyIntroduction
  - ファイルパス: `@backend/src/features/family/value-object/familyIntroduction.ts`
  - 概要: 家族紹介を表す値オブジェクト

- [x] ParentId
  - ファイルパス: `@backend/src/features/parent/value-object/parentId.ts`
  - 概要: 親IDを表す値オブジェクト

- [x] ParentName
  - ファイルパス: `@backend/src/features/parent/value-object/parentName.ts`
  - 概要: 親の名前を表す値オブジェクト

- [x] FamilyMemberId
  - ファイルパス: `@backend/src/features/family-member/value-object/familyMemberId.ts`
  - 概要: 家族メンバーIDを表す値オブジェクト

### バックエンド (エンティティ)
- [x] FamilyEntity
  - ファイルパス: `@backend/src/features/family/entity/familyEntity.ts`
  - 概要: 家族エンティティ

- [x] ParentEntity
  - ファイルパス: `@backend/src/features/parent/entity/parentEntity.ts`
  - 概要: 親エンティティ

- [x] FamilyMemberEntity
  - ファイルパス: `@backend/src/features/family-member/entity/familyMemberEntity.ts`
  - 概要: 家族メンバーエンティティ

### バックエンド (ドメインモデル)
- [x] Family
  - ファイルパス: `@backend/src/features/family/models/family.ts`
  - 概要: 家族ドメインモデル

- [x] Parent
  - ファイルパス: `@backend/src/features/parent/models/parent.ts`
  - 概要: 親ドメインモデル

### バックエンド (DAO)
- [x] FamilyDao
  - ファイルパス: `@backend/src/features/family/dao/familyDao.ts`
  - 概要: 家族データアクセスオブジェクト

- [x] ParentDao
  - ファイルパス: `@backend/src/features/parent/dao/parentDao.ts`
  - 概要: 親データアクセスオブジェクト

- [x] FamilyMemberDao
  - ファイルパス: `@backend/src/features/family-member/dao/familyMemberDao.ts`
  - 概要: 家族メンバーデータアクセスオブジェクト

### バックエンド (リポジトリ)
- [x] FamilyRepository
  - ファイルパス: `@backend/src/features/family/repository/familyRepository.ts`
  - 概要: 家族リポジトリ

- [x] ParentRepository
  - ファイルパス: `@backend/src/features/parent/repository/parentRepository.ts`
  - 概要: 親リポジトリ

### バックエンド (サービス)
- [x] createFamilyAndParent
  - ファイルパス: `@backend/src/features/family/services/createFamilyAndParent.ts`
  - 概要:
    - 家族作成サービス
    - トランザクション内で家族と親の両方を作成
    - バリデーション機能

### バックエンド (API)
- [x] authRouter.registerFamily
  - ファイルパス: `@backend/src/features/auth/router/authRouter.ts`
  - 概要:
    - 家族情報の登録
    - 親情報の登録
    - 親idと家族idを返却

### フロントエンド (モデル)
- [x] familyRegisterForm
  - ファイルパス: `@frontend/src/features/family/family-register-page/models/familyRegisterForm.ts`
  - 概要:
    - 家族登録フォームモデル
    - 家族情報と親情報を含む
    - BaseFormを継承

### フロントエンド (Store)
- [x] familyRegisterPageStore
  - ファイルパス: `@frontend/src/features/family/family-register-page/stores/familyRegisterPageStore.ts`
  - 概要:
    - BasePageStoreを継承

### フロントエンド（store）
- [x] familyRegisterFormStore
  - ファイルパス: `@frontend/src/features/family/family-register-page/stores/familyRegisterFormStore.ts`
  - 概要:
    - BaseFormStoreを継承
    - 家族フォームの状態管理

### フロントエンド (Service)
- [x] registerFamily
  - ファイルパス: `@frontend/src/features/family/family-register-page/services/registerFamily.ts`
  - 概要:
    - authRouter.registerFamilyを呼び出し
    - 家族と親の順次登録処理
    - エラーハンドリング

### フロントエンド (Hook - 基本機能)
- [x] useFamilyRegisterFormValidator
  - ファイルパス: `@frontend/src/features/family/family-register-page/hooks/useFamilyRegisterFormValidator.ts`
  - 概要:
    - フォームバリデーション
    - リアルタイム検証機能

### フロントエンド (Hook - ハンドラー)
- [x] useFamilyIdInputHandler
  - ファイルパス: `@frontend/src/features/family/family-register-page/handlers/useFamilyIdInputHandler.ts`
  - 概要:
    - 家族ID入力ハンドラー
    - 重複チェック機能
      - checkFamilyIdDuplicate関数
      - `@frontend/src/features/family/services/checkFamilyIdDuplicate.ts`
      - supabaseに直接クエリを実行

- [x] useFamilyIconSelectHandler
  - ファイルパス: `@frontend/src/features/family/family-register-page/handlers/useFamilyIconSelectHandler.ts`
  - 概要:
    - 家紋選択ハンドラー
    - アイコン選択画面への遷移

- [x] useParentEditHandler
  - ファイルパス: `@frontend/src/features/family/family-register-page/handlers/useParentEditHandler.ts`
  - 概要:
    - 親情報編集ハンドラー
    - 親編集画面への遷移

- [x] useFamilyRegisterSubmitHandler
  - ファイルパス: `@frontend/src/features/family/family-register-page/handlers/useFamilyRegisterSubmitHandler.ts`
  - 概要:
    - 確定ボタン押下ハンドラー
    - 登録処理と結果ハンドリング

### フロントエンド (Hook - 統合)
- [x] createFamilyRegisterPageHandlers
  - ファイルパス: `@frontend/src/features/family/family-register-page/hooks/createFamilyRegisterPageHandlers.ts`
  - 概要:
    - 統合フック - 全ハンドラーをまとめて提供

### フロントエンド (Components - 基底)
- [x] NavigationEntryLayout
  - ファイルパス: `@frontend/src/core/components/NavigationEntryLayout.tsx`
  - 概要:
    - 右矢印付きエントリーレイアウト
    - EntryLayoutの子要素として使用
    - タップ可能で幅いっぱいに広がる

### フロントエンド (Components - 入力)
- 各コンポーネント作成後、デモ画面のコンポーネント一覧にも配置すること（ComponentListPage.tsx）
- 
- [x] FamilyNameInput
  - ファイルパス: `@frontend/src/features/family/family-register-page/components/FamilyNameInput.tsx`
  - 概要:
    - 家族名入力コンポーネント
    - 後ろに"家"の固定文字付き

- [x] FamilyNameInputEntry
  - ファイルパス: `@frontend/src/features/family/family-register-page/components/FamilyNameInputEntry.tsx`
  - 概要:
    - EntryLayout使用
    - タイトル: 家族名
    - アイコン: home
    - 家族名入力コンポーネントを使用

- [x] OnlineFamilyNameInputEntry
  - ファイルパス: `@frontend/src/features/family/family-register-page/components/OnlineFamilyNameInputEntry.tsx`
  - 概要:
    - EntryLayout使用
    - タイトル: オンライン家族名
    - アイコン: globe
    - 後ろに"家"の固定文字付き
    - EntryLayoutのhelpTextでヒント表示

- [x] FamilyIdInput
  - ファイルパス: `@frontend/src/features/family/family-register-page/components/FamilyIdInput.tsx`
  - 概要:
    - 家族ID入力コンポーネント
    - 前に"@"マーク付き

- [x] FamilyIdInputEntry
  - ファイルパス: `@frontend/src/features/family/family-register-page/components/FamilyIdInputEntry.tsx`
  - 概要:
    - EntryLayout使用
    - タイトル: 家族ID
    - アイコン: それっぽいの
    - 家族ID入力コンポーネントを使用

- [x] IconSelectInput
  - ファイルパス: `@frontend/src/features/shared/components/IconSelectEntry.tsx`
  - 概要:
    - アイコン選択コンポーネント
    - NavigationEntryLayoutを使用
    - 左側にアイコン表示、右側に矢印
    - タイトル: 家紋

- [x] IconSelectInputEntry
  - ファイルパス: `@frontend/src/features/family/family-register-page/components/IconSelectInputEntry.tsx`
  - 概要:
    - EntryLayout使用
    - タイトル: 家紋
    - アイコン: それっぽいの
    - アイコン選択コンポーネントを使用

- [x] ParentInfoInput
  - ファイルパス: `@frontend/src/features/family/family-register-page/components/ParentInfoInput.tsx`
  - 概要:
    - 親情報表示コンポーネント
    - NavigationEntryLayoutを使用
    - 親編集画面への遷移機能

- [x] ParentInfoInputEntry
  - ファイルパス: `@frontend/src/features/family/family-register-page/components/ParentInfoInputEntry.tsx`
  - 概要:
    - EntryLayout使用
    - タイトル: 親情報
    - アイコン: それっぽいの
    - 親情報表示コンポーネントを使用

### フロントエンド (Page)
- [ ] FamilyRegisterPage
  - ファイルパス: `@frontend/src/features/family/family-register-page/FamilyRegisterPage.tsx`
  - 概要:
    - メイン画面コンポーネント
    - 全コンポーネントの統合
    - propsで確定ボタンハンドルを受け取り

### フロントエンド (Navigator)
- [ ] AuthNavigator更新
  - ファイルパス: `@frontend/src/features/auth/AuthNavigator.tsx`
  - 概要:
    - FamilyRegisterPage画面の追加
    - ルーティング設定

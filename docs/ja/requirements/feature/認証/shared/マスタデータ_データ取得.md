# マスタデータ_データ取得

## 概要
- バックエンドサーバ起動時にマスタデータを取得し、バックエンドのEnumの値を更新する。
- フロントエンドのアプリ起動時にtRPC経由でマスタデータを取得し、Enumの値を更新する。
- システムで使用されるEnum値は、データベースのマスタテーブルから動的に取得・更新される。

### 更新Enum
- 言語Enum: `LanguageType`
  - `JAPANESE`: 日本語（ID: 1）
  - `ENGLISH`: 英語（ID: 2）
- 家族メンバータイプEnum: `FamilyMemberType` 
  - `PARENT`: 親（ID: 1）
  - `CHILD`: 子供（ID: 2）

### 関連テーブル
- 言語テーブル（languages）
  - 主キー: id
  - 言語コード: code
  - 言語名: name
  - 有効フラグ: is_active
  - 表示順序: sort_order
- 家族メンバータイプテーブル（family_member_types）
  - 主キー: id
  - テーブル名: table_name
  - 説明: description

### 処理内容
- バックエンドサーバ起動時
  1. データベース（Supabase）から言語マスタデータを取得
  2. 取得したデータで`LanguageType` Enumの値を更新（`updateFromEntities`メソッド使用）
  3. データベースから家族メンバータイプマスタデータを取得
  4. 取得したデータで`FamilyMemberType` Enumの値を更新（`updateFromEntities`メソッド使用）
  5. 更新後、各Enum値のプロパティ（code、name、table_name、descriptionなど）にアクセス可能となる

### 実装場所
- エンティティ定義: 
  - `/packages/backend/src/features/language/entity/languageEntity.ts`
  - `/packages/backend/src/features/family-member/entity/familyMemberTypeEntity.ts`
- Enum定義:
  - `/packages/shared/features/language/enum/languageType.ts`
  - `/packages/shared/features/family-member/enum/familyMemberType.ts`

## フロントエンドEnum更新

### 引数
なし

### 取得データ
- 言語Enum値（Zodスキーマ形式）
- 家族メンバータイプEnum値（Zodスキーマ形式）

### 処理内容
- フロントエンドアプリ起動時
  1. tRPC経由でバックエンドからマスタデータのEnum値を取得
  2. 取得したZodスキーマデータで`LanguageType` Enumの値を更新（`setFromZodData`メソッド使用）
  3. 取得したZodスキーマデータで`FamilyMemberType` Enumの値を更新（`setFromZodData`メソッド使用）
  4. 更新後、フロントエンドでも各Enum値のプロパティにアクセス可能となる

### tRPCエンドポイント
- エンドポイント名: `masterData.getEnumValues` (仮)
- レスポンス形式:
```typescript
{
  languageType: {
    japanese: { id: 1, code: "ja", name: "Japanese", isActive: true, sortOrder: 1 },
    english: { id: 2, code: "en", name: "English", isActive: true, sortOrder: 2 }
  },
  familyMemberType: {
    parent: { id: 1, tableName: "parents", description: "親" },
    child: { id: 2, tableName: "children", description: "子供" }
  }
}
```

## 技術的詳細

### Enumアーキテクチャ
- 基底クラス: `BaseSimpleEnum`
- 値オブジェクト: `BaseSimpleEnumValue`を継承
- 動的更新機能: `updateFromEntities`、`setFromZodData`メソッド
- 型安全性: Zodスキーマによる検証
- シリアライゼーション: `toZodData`メソッドでJSON変換対応

### 設計パターン
- EnumMixinパターン: エンティティからの動的更新
- 値オブジェクトパターン: ドメイン値の封じ込め
- スキーマファーストパターン: Zodによる型安全な通信
